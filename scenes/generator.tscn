[gd_scene format=4 uid="uid://dmr2k3nr3ttgm"]

[ext_resource type="Script" path="res://scripts/generator.gd" id="1_w5vnv"]
[ext_resource type="PackedScene" uid="uid://c4ujeyr0po3jj" path="res://scenes/defect.tscn" id="2_ef8yp"]
[ext_resource type="Texture2D" uid="uid://y1qfgvamgahv" path="res://assets/dih.png" id="3_ef8yp"]

[sub_resource type="Gradient" id="Gradient_i7141"]
colors = PackedColorArray(0, 0, 0, 1, 0.36045092, 0.17922884, 0.025613934, 1)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_4mrxx"]
frequency = 0.0192

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_7r4gi"]
noise = SubResource("FastNoiseLite_4mrxx")
color_ramp = SubResource("Gradient_i7141")
seamless = true
as_normal_map = true
seamless_blend_skirt = 0.278

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_w7kh3"]
albedo_color = Color(0.30690926, 0.16513526, 0.028907763, 1)
normal_enabled = true
normal_scale = 1.45
normal_texture = SubResource("NoiseTexture2D_7r4gi")
uv1_triplanar = true

[sub_resource type="BoxMesh" id="BoxMesh_7r4gi"]
material = SubResource("StandardMaterial3D_w7kh3")
size = Vector3(10, 4, 3)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_w7kh3"]
points = PackedVector3Array(5, 2, 1.5, 5, 2, -1.5, -5, 2, 1.5, 5, -2, 1.5, 5, -2, -1.5, -5, 2, -1.5, -5, -2, 1.5, -5, -2, -1.5)

[sub_resource type="PlaneMesh" id="PlaneMesh_i7141"]
size = Vector2(5.755, 2.365)
center_offset = Vector3(0, 0.75, 1.5)
orientation = 2

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_rqoq6"]
albedo_texture = ExtResource("3_ef8yp")

[sub_resource type="ArrayMesh" id="ArrayMesh_10hea"]
_surfaces = [{
"aabb": AABB(-1.5825888, -1.239265, -2.6289842, 2.9868822, 2.9868822, 5.2579684),
"format": 34896613377,
"index_count": 84,
"index_data": PackedByteArray("AAABAAIAAwACAAEAAwAEAAIABQADAAEAAAAFAAEABgAEAAMABQAGAAMABwACAAQABwAAAAIABgAHAAQACAAFAAAACQAGAAUACAAJAAUACQAKAAYACgAHAAYACwAJAAgADAAAAAcACgAMAAcADAAIAAAADQAMAAoADgAIAAwADQAOAAwADgALAAgADwANAAoADwAOAA0ADwAKAAkADwALAA4ACwAPAAkA"),
"name": "Body",
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 16,
"vertex_data": PackedByteArray("AAC2UOr4AAAAAP//FAcAAAAA///q+AAA/////xQHAAD/////6vgAAAAAtlAUBwAA//+2UBQHAAD//7ZQ6vgAAAAA4jP//wAAAADiMwAAAAD//+IzAAAAAAAAAAD//wAA///iM///AAD//wAAAAAAAP//AAD//wAAAAAAAAAAAAA=")
}]
blend_shape_mode = 0

[sub_resource type="ArrayMesh" id="ArrayMesh_4pjfl"]
resource_name = "generator_Cube_002"
_surfaces = [{
"aabb": AABB(-1.5825888, -1.239265, -2.6289842, 2.9868822, 2.9868822, 5.2579684),
"attribute_data": PackedByteArray("NhcNz1Ht5XY2F+V2Ue0Nz/IQjN2V84zd8hCk95XzpPeAVDdHp6npDIBU6QynqTdHUe0NzzYX5XZR7eV2NhcNz5XzjN3yEIzdlfOk9/IQpPenqTdHgFTpDKep6QyAVDdHlfOk9/IQpPeV86T38hCk9/roiwUxvAVQMbyLBfroBVCnqc1QgFQ3R6epN0eAVM1QgFTNUKepN0eAVDdHp6nNUIBUEGKnqc1QgFTNUKepEGKnqRBigFTNUKepzVCAVBBi"),
"format": 34896613399,
"index_count": 84,
"index_data": PackedByteArray("AAABAAIAAAADAAEABAADAAAABAAFAAMABgAFAAQABgAHAAUACAAJAAoACAALAAkADAANAA4ADAAPAA0AEAAPAAwAEAARAA8AEgARABAAEgATABEAFAAVABYAFAAXABUAGAAZABoAGAAbABkAHAAdAB4AHAAfAB0AIAAhACIAIAAjACEAJAAlACYAJAAnACUAKAApACoAKAArACkALAAtAC4ALAAvAC0A"),
"material": SubResource("StandardMaterial3D_rqoq6"),
"name": "Body",
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 48,
"vertex_data": PackedByteArray("AAC2UOr4AAAAAP//FAcAAAAA///q+AAAAAC2UBQHAAAAAOIz//8AAAAA4jMAAAAAAAAAAP//AAAAAAAAAAAAAAAAtlAUBwAA/////xQHAAAAAP//FAcAAP//tlAUBwAA//+2UBQH/7//////6vj/v/////8UB/+///+2UOr4/7///+IzAAD/v///4jP///+///8AAAAA/7///wAA////v///tlDq+ACAAAD//+r4AID/////6vgAgAAAtlDq+ACAAAAAAAAA/7///wAA////v///AAAAAP+/AAAAAP///7//////FAf/vwAA///q+P+/AAD//xQH/7//////6vj/v///4jP//5+QAAC2UOr4n5D//7ZQ6vifkAAA4jP//5+QAADiMwAAnxD//7ZQFAefEAAAtlAUB58Q///iMwAAnxAAAAAAAAAAAP//4jMAAAAAAADiMwAAAAD//wAAAAAAAP//AAD//wCAAADiM///AID//+Iz//8AgAAAAAD//wCA/z//f/8//3//P/9//z//f/8//3//P/9//z//f/8//3////9/////f////3////9//38AAP9/AAD/fwAA/38AAP9/AAD/fwAA/38AAP9/AAD/f////3////9/////f///AAD/fwAA/38AAP9/AAD/f////3////9/////f////3////9/////f////3////9/////f////3////9/////f////3////9/////f////3//f////3////9/////f///")
}]
blend_shape_mode = 0
shadow_mesh = SubResource("ArrayMesh_10hea")

[node name="Generator" type="StaticBody3D" unique_id=1422162699]
script = ExtResource("1_w5vnv")
defect = ExtResource("2_ef8yp")
defect_position_padding = 0.3
defect_spawn_rate = 10.0
defect_spawn_rate_variability = 3.0
defect_lose_threshold = 6

[node name="MeshInstance3D" type="MeshInstance3D" parent="." unique_id=1629074328]
visible = false
mesh = SubResource("BoxMesh_7r4gi")

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=830310474]
transform = Transform3D(0.6202065, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)
shape = SubResource("ConvexPolygonShape3D_w7kh3")

[node name="RepairPlane" type="MeshInstance3D" parent="." unique_id=630042335]
mesh = SubResource("PlaneMesh_i7141")

[node name="Timer" type="Timer" parent="." unique_id=881121636]
one_shot = true

[node name="generator" type="Node3D" parent="." unique_id=612058480]
transform = Transform3D(-4.371139e-08, 0, 1.928163, 0, 1.3219545, 0, -1, 0, -8.428268e-08, -2.917842e-09, -0.6198425, -0.06675244)

[node name="Cube" type="MeshInstance3D" parent="generator" unique_id=1381079048]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 0.6096632, 0, 0.22286928, 0)
mesh = SubResource("ArrayMesh_4pjfl")
skeleton = NodePath("")

[connection signal="timeout" from="Timer" to="." method="_on_timer_timeout"]
